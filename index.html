<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>HK-GRUP - ক্লাইন্ট পেমেন্ট </title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#0b0b0b;
  color:#e0ffe0;
  font-family:monospace;
}
.header{
  background:#000;
  padding:1rem;
  text-align:center;
  border-bottom:2px solid #00ff99;
}
.header h1{margin:0;color:#00ff99}

.container{
  max-width:900px;
  margin:auto;
  padding:1rem;
}

input, select{
  width:100%;
  padding:.7rem;
  margin-bottom:.5rem;
  background:#111;
  border:1px solid #00ff99;
  color:#0f0;
}

.addBtn, .reportBtn{
  width:100%;
  padding:.7rem;
  background:#00ff99;
  border:none;
  font-weight:bold;
  cursor:pointer;
  margin-bottom:.5rem;
}

/* Table */
.tableWrap{
  margin-top:1rem;
  max-height:55vh;
  overflow-y:auto;
}
table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  font-size:.85rem;
}
th,td{
  border:1px solid #00ff99;
  padding:.3rem;
  text-align:center;
}
th{background:#003322}

/* Column width */
.col-no{width:32px;text-align:center}
.col-info{width:auto;text-align:left}
.col-status{width:50px;text-align:center;font-size:.75rem}
.col-action{width:100px;text-align:center;font-size:.7rem}

/* Info cell: ID + Name separate line */
.info-id{
  font-weight:bold;
  color:#b6ffb6;
  font-size:.9rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.info-name{
  font-size:.8rem;
  opacity:.7;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Status */
.unpaid{opacity:.35}
.paid{opacity:1;font-weight:bold;color:#b6ffb6}

/* Buttons */
button{
  padding:.2rem .35rem;
  margin:1px;
  border:none;
  cursor:pointer;
}
.paidBtn{background:#00aa66;color:#fff;font-size:.7rem}
.offBtn{background:#777;color:#000;font-size:.65rem}
.delBtn{background:#ff3333;color:#fff;font-size:.65rem}
</style>
</head>

<body>

<div class="header">
  <h1>এইচ কে মাসুদ</h1>
</div>

<div class="container">

<input id="cid" placeholder=" আইডি নাম্বার  (11 digit)">
<input id="cname" placeholder="গ্রাহক নাম:">

<div style="display:flex; gap:5px; margin-bottom:.5rem;">
  <select id="filterMonth">
    <option value="">অল মাস</option>
    <option value="1">জানুয়ারি </option><option value="2">ফেব্রুয়ারী </option>
    <option value="3">মার্চ</option><option value="4">এপ্রিল </option>
    <option value="5">মে</option><option value="6">জুন</option>
    <option value="7">জুলাই</option><option value="8">আগষ্ট </option>
    <option value="9">সেপ্টেম্বর </option>
    <option value="10">অক্টোবর </option><option value="11">নভেম্বর </option>
    <option value="12">ডিসেম্বর </option>
  </select>
  <input type="number" id="filterYear" placeholder="বছর">
</div>

<button class="addBtn" onclick="saveCustomer()">সেইভ করুন </button>
<button class="reportBtn" onclick="generateReport()">রানিং মাসের রিপোর্ট </button>

<div class="tableWrap">
<table>
<thead>
<tr>
  <th class="col-no">নং</th>
  <th class="col-info">গ্রাহক </th>
  <th class="col-status">Status</th>
  <th class="col-action">Action</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>
</div>

</div>
<script>
let editIndex = null;

function getData(){
  return JSON.parse(localStorage.getItem("hk_customers")) || [];
}

function setData(d){
  localStorage.setItem("hk_customers", JSON.stringify(d));
}

// Save Customer
function saveCustomer(){
  let id = cid.value.trim();
  let name = cname.value.trim();

  if(!id || !name){
    alert("ID এবং Name দিন");
    return;
  }

  let today = new Date();
  let month = today.getMonth() + 1;
  let year = today.getFullYear();

  let data = getData();
  let obj = { id, name, paid:false, month, year };

  if(editIndex === null){
    data.push(obj);
  } else {
    data[editIndex] = obj;
    editIndex = null;
  }

  setData(data);
  cid.value = "";
  cname.value = "";

  autoCheckPayments();
  load();
}

// Auto Month Check
function autoCheckPayments(){
  let data = getData();
  let now = new Date();
  let m = now.getMonth() + 1;
  let y = now.getFullYear();

  data.forEach(c => {
    if(c.month != m || c.year != y){
      c.paid = false;
      c.month = m;
      c.year = y;
    }
  });

  setData(data);
}

// Load Table
function load(){
  let data = getData();
  let filterM = filterMonth.value;
  let filterY = filterYear.value;

  list.innerHTML = "";

  data.forEach((c,i)=>{
    if((!filterM || c.month == filterM) && (!filterY || c.year == filterY)){
      list.innerHTML += `
      <tr class="${c.paid ? 'paid' : 'unpaid'}">
        <td class="col-no">${i+1}</td>
        <td class="col-info">
          <div class="info-id">${c.id}</div>
          <div class="info-name">${c.name}</div>
        </td>
        <td class="col-status">${c.paid ? 'PAID' : 'OFF'}</td>
        <td class="col-action">
          <button class="paidBtn" onclick="setPaid(${i},true)">PAID</button>
          <button class="offBtn" onclick="setPaid(${i},false)">OFF</button>
          <button class="delBtn" onclick="del(${i})">Del</button>
        </td>
      </tr>`;
    }
  });
}

function setPaid(i,val){
  let d = getData();
  d[i].paid = val;
  setData(d);
  load();
}

function del(i){
  let d = getData();
  if(confirm("Delete customer?")){
    d.splice(i,1);
    setData(d);
    load();
  }
}

// Filters
filterMonth.addEventListener("change", load);
filterYear.addEventListener("input", load);

// First Run
autoCheckPayments();
load();
</script>

</body>
</html>
